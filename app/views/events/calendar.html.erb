<!-- Page Header -->
<header class="w-full flex justify-center mt-4">
  <div class="max-w-3xl text-center">
    <h1 class="text-4xl font-extrabold text-slate-900 mb-3">
      My Event Calendar
    </h1>
    <p class="text-lg text-slate-600 mb-6">
      Here are the events you've registered for.
    </p>
    <p class="text-xs text-slate-500"> &nbsp </p>
  </div>
</header>
<!-- Conflict Alert Section -->
<% if @conflicts.any? %>
  <div class="w-full max-w-3xl mx-auto mb-6 bg-red-100 border border-red-300 rounded-lg p-4">
    <h2 class="text-lg font-semibold text-red-800 mb-2">⚠ Scheduling Conflicts Detected</h2>

    <% @conflicts.each do |c| %>
      <p class="text-red-700 text-sm mb-2">
        <strong><%= c[:event1].name %></strong>
        (<%= c[:event1].time.strftime("%b %d, %l:%M %p") %>)
        overlaps with
        <strong><%= c[:event2].name %></strong>
        (<%= c[:event2].time.strftime("%b %d, %l:%M %p") %>)
      </p>
    <% end %>
  </div>
<% end %>

<% if @distances.any? %>
  <div class="mb-6 p-4 bg-yellow-50 border border-yellow-300 rounded-lg">
    <h3 class="font-bold text-lg text-yellow-800 mb-2">Travel Time Notes</h3>

    <% @distances.each do |info| %>
      <p class="text-sm text-yellow-700">
        <strong><%= info[:event1].name %></strong> → <strong><%= info[:event2].name %></strong>  
        is <%= info[:distance_miles] %> miles away  
        (<%= info[:duration_minutes] %> min drive)
      </p>
    <% end %>
  </div>
<% end %>

<% if @events.any? %>

  <div class="w-full max-w-5xl mx-auto px-4">

    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 justify-items-center">

      <% @events.each do |event| %>
        <div class="border border-slate-200 rounded-xl p-5 bg-white shadow-sm hover:shadow-md transition max-w-sm w-full">

          <h2 class="text-xl font-semibold text-slate-900 mb-2">
            <%= event.name %>
          </h2>

          <p class="text-sm text-slate-600 mb-1">
            <strong>Date:</strong> <%= event.time&.strftime("%B %d, %Y") %>
          </p>

          <p class="text-sm text-slate-600 mb-1">
            <strong>Time:</strong> <%= event.time&.strftime("%l:%M %p") %>
          </p>

          <p class="text-sm text-slate-600 mb-1">
            <strong>Location:</strong> <%= event.location %>
          </p>

          <p class="text-sm text-slate-700 mt-3">
            <%= truncate(event.description.to_s, length: 120) %>
          </p>

          <%= button_to "Remove Registration",
                unregister_event_path(event),
                method: :post,
                class: "mt-4 inline-flex items-center justify-center rounded-lg px-3 py-2 text-sm font-semibold bg-red-600 text-white hover:bg-red-700 transition",
                form: { style: "display:inline;" } %>

          <p class="text-xs text-slate-500">
                &nbsp
              </p>

        </div>
      <% end %>

    </div>

  </div>

<% else %>

  <div class="text-center text-slate-500 mt-10">
    <p>You haven’t registered for any events yet.</p>
    <%= link_to "Browse Events",
          events_path,
          class: "inline-flex items-center justify-center mt-4 rounded-lg px-4 py-2 text-sm font-semibold bg-indigo-600 text-white hover:bg-indigo-700" %>
  </div>

<% end %>
